---
if (Astro.request.method === "GET") {
	const data = Astro.cookies.get("colibase");
    console.log(data);
    if (data !== undefined) {
        const res = await fetch("http://0.0.0.0:6700/api/logout", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                cookie: data,
            }),
        });
        const json = await res.json();
        console.log(json);
        if (json.status === 200) {
            Astro.cookies.delete("colibase", {
                path: "/",
            });
            console.log("deleted cookie");
            return Astro.redirect("/entry/login")
        } else {
            console.log("failed to delete cookie");
            return Astro.redirect("/entry/login");
        }
    } else {
        console.log("no cookie");
        return Astro.redirect("/entry/login");
    }
}
---

<script>
    window.location.href = "/entry/login";
    window.location.reload();
</script>